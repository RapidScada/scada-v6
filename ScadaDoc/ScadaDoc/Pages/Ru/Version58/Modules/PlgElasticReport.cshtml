@page "/ru/5.8/modules/plg-elastic-report"
@{
    Layout = "_ArticleLayout";
    ViewBag.Title = "Плагин Гибкий отчёт";
}

@section Styles {
    <link href="~/lib/prismjs/prism.css" rel="stylesheet" />
}

@section Scripts {
    <script src="~/lib/prismjs/prism.js"></script>
}

<nav class="doc-toc">
    <div class="h6">На этой странице</div>
    <hr>
    <ul>
        <li><a href="#overview">Обзор</a></li>
        <li><a href="#installation">Установка</a></li>
        <li>
            <a href="#configuring">Конфигурирование отчёта</a>
            <ul>
                <li><a href="#configuration-file">Файл конфигурации отчёта</a></li>
                <li><a href="#report-styling">Стили отчёта</a></li>
                <li><a href="#add-report">Добавление отчёта в базу конфигурации</a></li>
            </ul>
        </li>
    </ul>
</nav>

<div class="doc-content">
    <h1>Плагин Гибкий отчёт</h1>

    <h2 id="overview">Обзор</h2>

    <p>Плагин Гибкий отчёт позволяет генерировать отчёты в соответствии с пользовательской конфигурацией. С помощью данного плагина Вы можете построить практически любой необходимый отчёт. Пользователю достаточно выбрать период и нажать на кнопку генерации отчёта. Администратор предварительно создаёт конфигурации отчёта, которые определяют набор секций различной формы, из которых состоит отчёт, и связывают столбцы и строки отчёта с данными системы.</p>

    <h2 id="installation">Установка</h2>

    <p>Сначала необходимо выполнить общую последовательность установки плагина, которая описана по <a href="../installation-and-run/module-installation#plugins">ссылке</a>. А затем выполнить несколько дополнительных действий:</p>

    <ol>
        <li>Перейти на страницу <em>Главное меню &gt; Регистрация &gt; Гибкий отчёт</em>.</li>
        <li>Зарегистрировать плагин, используя гиперссылки, размещённые на странице.</li>
        <li>Добавить регистрационный ключ в проект, скачав настройки Вебстанции с помощью приложения Администратор.</li>
    </ol>

    <h2 id="configuring">Конфигурирование отчёта</h2>

    <p>Отчёты состоят из набора секций, которые выводятся в выходной документ одна за другой. Каждая секция имеет свой тип, параметры и привязку к данным. Кроме того, отчёт имеет общие параметры, влияющие на все секции. Один и тот же отчёт может быть сгенерирован в различных форматах. В настоящий момент поддерживаются форматы Excel, PDF и HTML. При этом внешний вид одного и того же отчёта, сгенерированного в разных форматах, может незначительно отличаться.</p>

    <h3 id="configuration-file">Файл конфигурации отчёта</h3>

    <p>Файл конфигурации задаёт форматирование отчёта и определяет привязку данных отчёта к входным каналам. Для каждой отчётной формы создаётся отдельный файл конфигурации. Файл конфигурации имеет формат XML. Он должен быть сохранён в директории интерфейса или в её поддиректории внутри проекта.</p>

    <p>В дистрибутиве плагина содержится пример файла конфигурации отчёта SCADA\Interface\ElasticReport\ElasticRepExample.xml. Данный пример включает подробное описание параметров настройки и демонстрирует формирование секций отчёта всех возможных типов.</p>

    <p>Редактирование файлов конфигурации может осуществляться в любом текстовом редакторе. Например, для бесплатного редактора <a href="https://notepad-plus-plus.org/" target="_blank">Notepad++</a> существует плагин для удобной работы с файлами XML.</p>

    <h3 id="report-styling">Стили отчёта</h3>

    <p>Имеется возможность настроить собственные стили отчётов: шрифты, цвета, размеры ячеек и т.д.</p>

    <p>
        Стили отчёта для выгрузки в формате Excel настраиваются в файле<br />
        SCADA\ScadaWeb\plugins\ElasticReport\templates\ElasticRepExcel.xml
    </p>

    <p>Чтобы создать собственные стили, необходимо открыть этот файл в программе Excel  и перейти на страницу <em>Custom Styles</em>, на которой разрешается создание дополнительных стилей. В качестве примера рекомендуется использовать стили со страницы <em>Default Styles</em>.</p>

    <p>
        Пользовательские стили отчёта для выгрузки в формате PDF задаются в файле<br />
        SCADA\ScadaWeb\plugins\ElasticReport\templates\ElasticRepPdfCustom.xml
    </p>

    <p>Файл XML, описывающий стили для формата PDF, редактируется вручную в любом текстовом редакторе. В качестве примера удобно использовать стили PDF по умолчанию из файла ElasticRepPdfDefault.xml.</p>

    <p>
        Стили отчёта для выгрузки в HTML настраиваются в файле<br />
        SCADA\ScadaWeb\plugins\ElasticReport\css\customstyles.css согласно правилам каскадных таблиц стилей.
    </p>

    <h3 id="add-report">Добавление отчёта в базу конфигурации</h3>

    <p>Чтобы отчёт появился в списке доступных отчётов, его нужно прописать в таблице <em>Интерфейс</em> с помощью программы Администратор. Необходимо указать путь к файлу конфигурации отчёта относительно директории интерфейса, указать тип отчёта ElasticRep и ввести произвольный заголовок (см. рис.). После передачи проекта на сервер, отчёт будет доступен на странице <em>Главное меню &gt; Отчёты</em>.</p>

    <figure class="figure">
        <img src="plg-elastic-report-files/report_itf_file_ru.png" class="figure-img img-fluid" alt="Файл дэшборда" />
    </figure>

    <figure class="figure">
        <img src="plg-elastic-report-files/report_itf_tbl_ru.png" class="figure-img img-fluid" alt="Редактирование таблицы Интерфейс" />
    </figure>
</div>
