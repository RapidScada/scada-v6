@page "/ru/5.8/software-configuration/tune-database"
@{
    Layout = "_ArticleLayout";
    ViewBag.Title = "Настройка базы конфигурации";
}

<nav class="doc-toc">
    <div class="h6">На этой странице</div>
    <hr>
    <ul>
        <li><a href="#database-structure">Структура базы конфигурации</a></li>
        <li><a href="#editing-database">Редактирование базы конфигурации</a></li>
    </ul>
</nav>

<div class="doc-content">
    <h1>Настройка базы конфигурации</h1>

    <h2 id="database-structure">Структура базы конфигурации</h2>

    <p>База конфигурации представляет собой структурированное описание всей автоматизированной системы. Приложения, входящие в состав Rapid SCADA, используют информацию из базы конфигурации в сочетании со своими параметрами настройки.</p>

    <p>База конфигурации редактируется с помощью программы Администратор как часть проекта. Редактируемый экземпляр базы конфигурации имеет формат XML. При передаче проекта на сервер для выполнения база конфигурации конвертируется в специально разработанный формат DAT.</p>

    <p>База конфигурации состоит из таблиц, которые, в свою очередь, состоят из столбцов и строк. Каждая таблица относится к одной из следующих групп:</p>

    <ol>
        <li><em>Система</em>. Данная группа содержит таблицы, с помощью которых настраивается конфигурация конкретной автоматизированной системы.</li>
        <li><em>Справочники</em>. Данная группа содержит вспомогательные таблицы. В большинстве случаев их изменение не требуется.</li>
    </ol>

    <p>Далее приводится перечень таблиц базы конфигурации с их назначением.</p>

    <table class="table table-hover">
        <thead>
            <tr>
                <th>Таблица</th>
                <th>Назначение</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td colspan="2"><strong>Система</strong></td>
            </tr>
            <tr>
                <td><em>Объекты</em></td>
                <td>Содержит логические объекты, которые используются для структурирования информации в системе</td>
            </tr>
            <tr>
                <td><em>Линии связи</em></td>
                <td>Описывает физические линии связи, по которым производится обмен данными с устройствами</td>
            </tr>
            <tr>
                <td><em>КП</em></td>
                <td>Содержит контролируемые пункты (КП) - физические или мнимые устройства, с которыми происходит обмен данными</td>
            </tr>
            <tr>
                <td><em>Входные каналы</em></td>
                <td>Определяет входные данные системы, поступающие с устройств, а также значения, вычисляемые на их основе</td>
            </tr>
            <tr>
                <td><em>Каналы управления</em></td>
                <td>Определяет команды, выполняемые системой</td>
            </tr>
            <tr>
                <td><em>Роли</em></td>
                <td>Содержит роли. Роль - это набор функциональных возможностей, доступных пользователю</td>
            </tr>
            <tr>
                <td><em>Пользователи</em></td>
                <td>Содержит перечень пользователей системы с указанием ролей</td>
            </tr>
            <tr>
                <td><em>Интерфейс</em></td>
                <td>Содержит описание объектов интерфейса (представлений, отчётов и окон данных)
            </tr>
            <tr>
                <td><em>Права</em></td>
                <td>Определяет права на объекты интерфейса по ролям</td>
            </tr>
            <tr>
                <td colspan="2"><strong>Справочники</strong></td>
            </tr>
            <tr>
                <td><em>Типы каналов</em></td>
                <td>Справочник типов входных каналов</td>
            </tr>
            <tr>
                <td><em>Типы команд</em></td>
                <td>Справочник типов команд, которые могут использоваться каналами управления</td>
            </tr>
            <tr>
                <td><em>Типы событий</em></td>
                <td>Справочник типов событий системы, а также статусов входных каналов в архиве</td>
            </tr>
            <tr>
                <td><em>Типы КП</em></td>
                <td>Справочник типов КП (устройств)</td>
            </tr>
            <tr>
                <td><em>Величины</em></td>
                <td>Справочник измеряемых физических величин</td>
            </tr>
            <tr>
                <td><em>Размерности</em></td>
                <td>Справочник размерностей значений входных каналов, а также перечислимые значения каналов</td>
            </tr>
            <tr>
                <td><em>Значения команд</em></td>
                <td>Справочник значений команд, которые вызываются посредством каналов управления</td>
            </tr>
            <tr>
                <td><em>Форматы чисел</em></td>
                <td>Справочник форматов, используемых при выводе значений входных каналов</td>
            </tr>
            <tr>
                <td><em>Формулы</em></td>
                <td>Справочник формул, используемых при расчётах данных входных каналов и значений команд каналов управления</td>
            </tr>
        </tbody>
    </table>

    <h2 id="editing-database">Редактирование базы конфигурации</h2>

    <p>Таблицы базы конфигурации связаны между собой, то есть значение одной таблицы может ссылаться на запись из другой таблицы. Например, каждый КП ссылается на линию связи, к которой он относится. Поэтому редактирование таблиц удобно выполнять в определённой последовательности. Для таблиц из группы <em>Система</em> ввод данных обычно выполняется по порядку, начиная с таблицы <em>Объекты</em>, заканчивая таблицей <em>Права</em>.</p>

    <p>При добавлении линий связи и КП рекомендуется использовать мастеры, которые вызываются с помощью кнопок <img src="../common-images/add_line.png" /> и <img src="../common-images/add_device.png" />. Использование мастера позволяет не только добавить запись в таблицу базы конфигурации, но также создать соответствующую сущность в настройках Коммуникатора. Для создания входных каналов и каналов управления предназначен мастер, вызываемый кнопкой <img src="../common-images/create_cnls.png" />. Однако автоматическое создание каналов должно поддерживаться используемыми драйверами КП, иначе каналы необходимо прописать вручную.</p>

    <p>Если на панели инструментов таблицы отображается кнопка <img src="../common-images/props.png" />, значит для данной таблицы доступно редактирование записей с помощью формы. Формы для редактирования свойств канала показаны на рис. 1 и 2.</p>

    <figure class="figure">
        <img src="tune-database-files/in_cnl_props_ru.png" class="figure-img img-fluid" alt="Свойства входного канала" />
        <figcaption class="figure-caption">Рис. 1. Свойства входного канала</figcaption>
    </figure>

    <figure class="figure">
        <img src="tune-database-files/out_cnl_props_ru.png" class="figure-img img-fluid" alt="Свойства канала управления" />
        <figcaption class="figure-caption">Рис. 2. Свойства канала управления</figcaption>
    </figure>

    <p>Создание базы конфигурации можно значительно ускорить, если использовать сделанные ранее наработки. Для обмена информацией между различными базами программа Администратор имеет функции <em>Импортировать таблицу</em> и <em>Экспортировать таблицу</em>  (рис. 3 и 4), которые вызываются из меню <em>Файл</em>. Таблицы экспортируются в файлы формата DAT, XML и CSV. Затем информация может быть импортирована из файлов формата DAT и XML в тот же самый или другой проект. Существует возможность ограничить перечень выгружаемых и закачиваемых данных, задав начальный и конечный идентификаторы. Кроме того, если при импорте назначить новый начальный идентификатор, то импорт данных выполнится со смещением идентификаторов.</p>

    <figure class="figure">
        <img src="tune-database-files/admin_import_table_ru.png" class="figure-img img-fluid" alt="Импорт таблицы" />
        <figcaption class="figure-caption">Рис. 3. Импорт таблицы</figcaption>
    </figure>

    <figure class="figure">
        <img src="tune-database-files/admin_export_table_ru.png" class="figure-img img-fluid" alt="Экспорт таблицы" />
        <figcaption class="figure-caption">Рис. 4. Экспорт таблицы</figcaption>
    </figure>

    <p>Для входных каналов и каналов управления доступен инструмент клонирования (рис. 5). На форме параметров клонирования необходимо задать исходные номера и номера назначения каналов. Также можно выбрать новый объект и КП для клонированных каналов. Функция обновления номеров каналов в формулах работает, если номер канала используется как аргумент в следующих функциях: N(), Val(), Stat(), SetVal(), SetStat() и SetData().</p>

    <figure class="figure">
        <img src="tune-database-files/admin_clone_cnls_ru.png" class="figure-img img-fluid" alt="Клонирование каналов" />
        <figcaption class="figure-caption">Рис. 5. Клонирование каналов</figcaption>
    </figure>

    <p>Для ячеек таблицы доступны функции копирования (Ctrl + C) и вставки (Ctrl + V). Если щёлкнуть по заголовку столбца, строки таблицы отсортируются по значениям данного столбца. Функция поиска и замены (Ctrl + F) также позволяет ускорить редактирование.</p>
</div>
